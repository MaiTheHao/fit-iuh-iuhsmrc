<!doctype html>
<html xmlns:th="http://www.thymeleaf.org">
	<body>
		<!-- Fragment Definition -->
		<div th:fragment="modal_content" class="modal fade" id="automationModal" tabindex="-1" role="dialog" aria-hidden="true">
			<div class="modal-dialog modal-lg modal-dialog-centered" role="document">
				<div class="modal-content border-0 shadow-lg">
					<!-- Header -->
					<div class="modal-header bg-primary text-white py-3">
						<h5 class="modal-title font-weight-bold" id="modalTitle"><i class="fas fa-calendar-alt mr-2"></i> Scheduler Config</h5>
						<button type="button" class="close text-white opacity-1" data-dismiss="modal">
							<span aria-hidden="true">&times;</span>
						</button>
					</div>

					<!-- Body -->
					<div class="modal-body bg-light">
						<form id="automationForm">
							<input type="hidden" id="autoId" />

							<!-- Section 1: Task Info & Status -->
							<div class="card shadow-sm border-0 mb-3">
								<div class="card-body p-3">
									<div class="row align-items-center">
										<div class="col-md-9">
											<div class="form-group mb-0">
												<label class="small text-muted text-uppercase font-weight-bold">Automation Name <span class="text-danger">*</span></label>
												<input type="text" class="form-control font-weight-bold text-primary" id="autoName" required placeholder="Ex: Tắt đèn sân vườn" />
											</div>
										</div>
										<div class="col-md-3 text-right">
											<div class="custom-control custom-switch mt-4">
												<input type="checkbox" class="custom-control-input" id="autoIsActive" checked />
												<label class="custom-control-label font-weight-bold small text-uppercase" for="autoIsActive">Active</label>
											</div>
										</div>
									</div>
								</div>
							</div>

							<!-- Section 2: Timeline & Frequency -->
							<div class="card shadow-sm border-0 mb-3">
								<div class="card-body p-3">
									<div class="row">
										<!-- Cột 1: Time Picker (Giờ chạy) -->
										<div class="col-md-6 border-right">
											<label class="small text-muted text-uppercase font-weight-bold"><i class="far fa-clock mr-1"></i> Execution Time</label>
											<input type="text" class="form-control font-weight-bold datetime-input" id="startTimePicker" />
											<small class="text-muted d-block mt-1">Select Hour & Minute</small>
										</div>

										<!-- Cột 2: Pattern (Kiểu lặp) -->
										<div class="col-md-6">
											<label class="small text-muted text-uppercase font-weight-bold"><i class="fas fa-sync-alt mr-1"></i> Repeat Pattern</label>
											<select class="form-control custom-select font-weight-bold" id="scheduleType">
												<option value="DAILY">Daily (Hàng ngày)</option>
												<option value="WEEKLY">Weekly (Hàng tuần)</option>
												<option value="MONTHLY">Monthly (Hàng tháng)</option>
												<option value="ONCE">Once (Một lần)</option>
											</select>
											<small class="text-muted d-block mt-1" id="patternDesc">Runs every day</small>
										</div>
									</div>
								</div>
							</div>

							<!-- Section 3: Dynamic Options (Advanced) -->
							<div class="card shadow-sm border-0 bg-white mb-3" id="dynamicScheduleArea">
								<div class="card-body p-3">
									<!-- CASE: SIMPLE -->
									<div class="schedule-option d-none" id="opt-simple">
										<div class="alert alert-light border-0 mb-0 text-center text-muted">
											<i class="fas fa-info-circle text-primary mr-2"></i>
											<span id="simpleMessage">Runs daily at the specified time.</span>
										</div>
									</div>

									<!-- CASE: WEEKLY -->
									<div class="schedule-option d-none" id="opt-weekly">
										<label class="small text-muted text-uppercase font-weight-bold mb-2">Select Days of Week</label>
										<div class="d-flex justify-content-between flex-wrap btn-group-toggle" data-toggle="buttons">
											<label class="btn btn-outline-secondary btn-sm flex-fill m-1 rounded border-0 shadow-sm">
												<input type="checkbox" name="weekDays" value="MON" /> Mon
											</label>
											<label class="btn btn-outline-secondary btn-sm flex-fill m-1 rounded border-0 shadow-sm">
												<input type="checkbox" name="weekDays" value="TUE" /> Tue
											</label>
											<label class="btn btn-outline-secondary btn-sm flex-fill m-1 rounded border-0 shadow-sm">
												<input type="checkbox" name="weekDays" value="WED" /> Wed
											</label>
											<label class="btn btn-outline-secondary btn-sm flex-fill m-1 rounded border-0 shadow-sm">
												<input type="checkbox" name="weekDays" value="THU" /> Thu
											</label>
											<label class="btn btn-outline-secondary btn-sm flex-fill m-1 rounded border-0 shadow-sm">
												<input type="checkbox" name="weekDays" value="FRI" /> Fri
											</label>
											<label class="btn btn-outline-secondary btn-sm flex-fill m-1 rounded border-0 shadow-sm">
												<input type="checkbox" name="weekDays" value="SAT" /> Sat
											</label>
											<label class="btn btn-outline-danger btn-sm flex-fill m-1 rounded border-0 shadow-sm">
												<input type="checkbox" name="weekDays" value="SUN" /> Sun
											</label>
										</div>
									</div>

									<!-- CASE: MONTHLY (GRID) -->
									<div class="schedule-option d-none" id="opt-monthly">
										<div class="d-flex justify-content-between align-items-center mb-2">
											<label class="small text-muted text-uppercase font-weight-bold mb-0">Select Days of Month</label>
											<small class="text-primary cursor-pointer" id="btnResetMonth">Reset</small>
										</div>

										<div class="d-flex flex-wrap justify-content-center" id="monthGrid">
											<!-- Grid 1-31 -->
											<th:block th:each="i : ${#numbers.sequence(1, 31)}">
												<button
													type="button"
													class="btn btn-outline-light text-dark border day-cell m-1 p-0 shadow-sm"
													style="width: 32px; height: 32px; font-size: 0.8rem"
													th:data-val="${i}"
													th:text="${i}"
												>
													1
												</button>
											</th:block>
										</div>
									</div>
								</div>
							</div>

							<!-- Description -->
							<div class="form-group mb-0">
								<textarea
									class="form-control bg-light text-muted small"
									id="autoDescription"
									rows="2"
									placeholder="Optional description for this automation..."
								></textarea>
							</div>
						</form>
					</div>

					<!-- Footer -->
					<div class="modal-footer bg-light border-top-0 py-2">
						<button type="button" class="btn btn-sm btn-light font-weight-bold" data-dismiss="modal">Close</button>
						<button type="button" class="btn btn-sm btn-primary px-4 shadow-sm font-weight-bold" id="btnSaveAutomation">
							<i class="fas fa-save mr-1"></i> Save Config
						</button>
					</div>
				</div>
			</div>
		</div>
	</body>
</html>
